# 제품 컨텍스트 및 이슈 관리

## 에러 확인 및 솔루션 기록

### 해결된 이슈

#### 1. 계정 삭제 기능 누락 (1단계)
**문제**: CLI에서 계정 삭제 명령어가 구현되지 않음
**원인**: account_commands.py에 delete 명령어 누락
**해결책**: 
- `delete_account` 명령어 추가
- `--force` 옵션으로 확인 없이 삭제 가능
- 관련 인증 설정도 함께 삭제하는 로직 구현

**예방조치**: 
- CRUD 기능 구현 시 모든 연산(Create, Read, Update, Delete) 체크리스트 작성
- 유즈케이스와 CLI 명령어 매핑 문서 유지

#### 2. 계정 업데이트 시 인증 타입 변경 복잡성
**문제**: 인증 타입 변경 시 기존 설정 처리 방법 불명확
**원인**: 도메인 모델에서 인증 타입과 설정의 관계 이해 부족
**해결책**: 
- 인증 타입은 단순한 enum 값 변경으로 처리
- 실제 인증 설정은 별도 관리
- 기존 설정 유지하면서 타입만 변경

**예방조치**:
- 도메인 엔티티 간 관계 명확히 문서화
- 업데이트 로직의 단위 테스트 강화

### 현재 알려진 이슈

#### 1. 토큰 저장 보안 (2단계 예정)
**문제**: 토큰을 평문으로 저장할 위험
**계획된 해결책**:
- cryptography 라이브러리 사용
- 환경변수 기반 암호화 키 관리
- 토큰 저장 시 자동 암호화, 조회 시 자동 복호화

#### 2. 비동기 처리 일관성
**문제**: CLI와 API 간 동기/비동기 처리 차이
**계획된 해결책**:
- Core 유즈케이스는 모두 비동기로 구현
- CLI에서는 asyncio.run()으로 동기 호출
- API에서는 직접 비동기 호출

## 사용자 피드백 및 개선사항

### 긍정적 피드백
- "조회하고 등록하는 기능은 잘 된거 같아요" - 1단계 계정 관리 기능 만족

### 개선 요청사항
- 현재까지 특별한 개선 요청 없음
- 다음 단계(인증 시스템) 진행 요청

## 품질 관리

### 코드 품질 체크리스트
- [x] 클린 아키텍처 원칙 준수
- [x] 포트/어댑터 패턴 적용
- [x] Pydantic V2 데이터 검증
- [x] 타입 힌트 적용
- [x] 에러 처리 구현
- [ ] 단위 테스트 커버리지 (진행 중)
- [ ] 통합 테스트 (예정)
- [ ] 문서화 완성도 (진행 중)

### 성능 모니터링
- **데이터베이스 쿼리**: 현재 단순 CRUD, 최적화 필요 없음
- **메모리 사용량**: 정상 범위
- **응답 시간**: CLI 명령어 즉시 응답

### 보안 체크리스트
- [x] 환경변수로 민감 정보 분리
- [x] SQL 인젝션 방지 (SQLAlchemy ORM 사용)
- [ ] 토큰 암호화 (2단계 예정)
- [ ] HTTPS 강제 (API 구현 시)
- [ ] 입력 검증 강화 (진행 중)

## 사용자 경험 개선

### CLI 사용성
**현재 상태**:
- Rich 라이브러리로 시각적 개선
- 명확한 에러 메시지
- 일관된 명령어 구조

**개선 계획**:
- 프로그레스바 추가 (긴 작업 시)
- 자동 완성 기능 (bash/zsh)
- 도움말 메시지 개선

### 에러 메시지 개선
**현재 구현**:
- 비즈니스 로직 예외를 의미 있는 메시지로 변환
- CLI에서 사용자 친화적 출력

**개선 계획**:
- 다국어 지원 (한국어/영어)
- 해결 방법 제안 포함
- 로그 레벨별 상세도 조정

## 테스트 전략 및 결과

### 완료된 테스트
- **계정 등록**: 실제 Azure 계정으로 성공
- **계정 조회**: 목록 및 상세 조회 정상
- **계정 업데이트**: 표시 이름, 인증 타입 변경 성공
- **계정 삭제**: 테스트 계정 삭제 성공

### 테스트 환경
- **데이터베이스**: SQLite (dev_database.db)
- **실제 데이터**: kimghw@krs.co.kr 계정 등록됨
- **CLI 테스트**: 모든 명령어 수동 검증 완료

### 다음 단계 테스트 계획
- **OAuth 인증**: 실제 Azure AD 연동 테스트
- **토큰 관리**: 저장/갱신/삭제 테스트
- **에러 시나리오**: 네트워크 오류, 인증 실패 등
- **성능 테스트**: 다중 계정 처리 성능

## 배포 및 운영 고려사항

### 현재 배포 상태
- **환경**: 로컬 개발 환경만
- **데이터**: SQLite 파일 기반
- **설정**: .env 파일 기반

### 운영 환경 준비사항
- **데이터베이스**: PostgreSQL 마이그레이션
- **보안**: 토큰 암호화, HTTPS 적용
- **모니터링**: 로그 수집, 메트릭 수집
- **백업**: 정기적인 데이터 백업 전략

## 기술 부채 관리

### 현재 기술 부채
1. **테스트 커버리지 부족**: 단위 테스트 미구현
2. **문서화 불완전**: API 문서, 사용자 가이드 부족
3. **에러 처리 일관성**: 일부 예외 상황 처리 미흡

### 해결 우선순위
1. **높음**: 토큰 보안 구현 (2단계)
2. **중간**: 단위 테스트 작성
3. **낮음**: 문서화 완성

### 리팩토링 계획
- **코드 중복 제거**: 공통 유틸리티 함수 추출
- **타입 안정성 강화**: mypy 도입
- **성능 최적화**: 필요 시 쿼리 최적화
